# -*- coding: utf-8 -*-
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–≤—Ü–∞ Ozon –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤.
–°–æ–∑–¥–∞—ë—Ç –¥–≤–∞ CSV —Ñ–∞–π–ª–∞: products.csv –∏ sales.csv

–í–ê–ñ–ù–û –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –≤ PostgreSQL —á–µ—Ä–µ–∑ DBeaver:
1. –í—Å–µ —á–∏—Å–ª–∞ –ë–ï–ó –∫–∞–≤—ã—á–µ–∫ –∏ –ø—Ä–æ–±–µ–ª–æ–≤
2. –î–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ 'YYYY-MM-DD' (–Ω–∞–ø—Ä–∏–º–µ—Ä: 2025-01-15)
3. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ CSV —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
4. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å - –∑–∞–ø—è—Ç–∞—è (,)
5. –ö–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8 —Å BOM –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
"""

import csv
import os
import random
import sys
from datetime import datetime, timedelta

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏ Windows (—á—Ç–æ–±—ã —Ä—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
if sys.platform == 'win32':
    sys.stdout.reconfigure(encoding='utf-8')

# ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
# –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV —Ñ–∞–π–ª–æ–≤
OUTPUT_FOLDER = r'C:\Users\Nimos\Desktop\OZON_Analytycs'

# –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤
CATEGORIES = ['–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', '–û–¥–µ–∂–¥–∞', '–ö–Ω–∏–≥–∏', '–î–æ–º', '–ö—Ä–∞—Å–æ—Ç–∞']

# –ë—Ä–µ–Ω–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø–æ—Ä—è–¥–∫—É CATEGORIES)
BRANDS = ['Xiaomi', 'Nike', '–ú–∞–Ω–Ω –ò–≤–∞–Ω–æ–≤ –§–µ—Ä–±–µ—Ä', 'IKEA', 'Loreal']

# –ü—Ä–∏–º–µ—Ä—ã –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
PRODUCT_NAMES = {
    '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞': ['–°–º–∞—Ä—Ç—Ñ–æ–Ω Xiaomi Redmi Note 12', '–ù–∞—É—à–Ω–∏–∫–∏ Bluetooth', '–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', 
                    '–£–º–Ω—ã–µ —á–∞—Å—ã', '–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞', '–í–µ–±-–∫–∞–º–µ—Ä–∞', '–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è', 
                    '–ú—ã—à—å –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è', '–ü–ª–∞–Ω—à–µ—Ç', '–ó–∞—Ä—è–¥–∫–∞ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞'],
    '–û–¥–µ–∂–¥–∞': ['–§—É—Ç–±–æ–ª–∫–∞', '–î–∂–∏–Ω—Å—ã', '–ö—É—Ä—Ç–∫–∞', '–°–≤–∏—Ç—à–æ—Ç', '–ö—Ä–æ—Å—Å–æ–≤–∫–∏', '–®–æ—Ä—Ç—ã', '–ü–ª–∞—Ç—å–µ', 
               '–¢–æ–ª—Å—Ç–æ–≤–∫–∞', '–ë—Ä—é–∫–∏', '–ö–µ–ø–∫–∞'],
    '–ö–Ω–∏–≥–∏': ['–ö–Ω–∏–≥–∞ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é', '–†–æ–º–∞–Ω', '–£—á–µ–±–Ω–∏–∫', '–î–µ—Ç—Å–∫–∞—è –∫–Ω–∏–≥–∞', '–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è',
              '–°–ª–æ–≤–∞—Ä—å', '–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞', '–ë–∏–∑–Ω–µ—Å-–∫–Ω–∏–≥–∞', '–ö–æ–º–∏–∫—Å', '–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫'],
    '–î–æ–º': ['–ù–∞–±–æ—Ä –ø–æ—Å—É–¥—ã', '–ü–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å—ë', '–í–∞–∑–∞', '–°–≤–µ—Ç–∏–ª—å–Ω–∏–∫', '–ü–æ–ª–æ—Ç–µ–Ω—Ü–µ', 
            '–î–µ—Ä–∂–∞—Ç–µ–ª—å –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞', '–û—Ä–≥–∞–Ω–∞–π–∑–µ—Ä', '–ö–æ–≤—Ä–∏–∫', '–ö—Ä—ã—à–∫–∏ –¥–ª—è –±–∞–Ω–æ–∫', '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä'],
    '–ö—Ä–∞—Å–æ—Ç–∞': ['–®–∞–º–ø—É–Ω—å', '–ö—Ä–µ–º –¥–ª—è –ª–∏—Ü–∞', '–ü–æ–º–∞–¥–∞', '–¢—É—à—å –¥–ª—è —Ä–µ—Å–Ω–∏—Ü', '–õ–æ—Å—å–æ–Ω', 
                '–ú–∞—Å–∫–∞ –¥–ª—è –≤–æ–ª–æ—Å', '–°—ã–≤–æ—Ä–æ—Ç–∫–∞', '–î–µ–∑–æ–¥–æ—Ä–∞–Ω—Ç', '–ü–∞—Ä—Ñ—é–º', '–ì–µ–ª—å –¥–ª—è –¥—É—à–∞'],
}

# 15 —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤
CITIES = ['–ú–æ—Å–∫–≤–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', '–ö–∞–∑–∞–Ω—å', 
          '–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥', '–ß–µ–ª—è–±–∏–Ω—Å–∫', '–°–∞–º–∞—Ä–∞', '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É', '–£—Ñ–∞',
          '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫', '–í–æ—Ä–æ–Ω–µ–∂', '–ü–µ—Ä–º—å', '–í–æ–ª–≥–æ–≥—Ä–∞–¥', '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä']

# –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ (85% –¥–æ—Å—Ç–∞–≤–ª–µ–Ω, 10% –æ—Ç–º–µ–Ω–µ–Ω, 5% –≤–æ–∑–≤—Ä–∞—Ç)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏
STATUSES = ['–î–æ—Å—Ç–∞–≤–ª–µ–Ω'] * 85 + ['–û—Ç–º–µ–Ω–µ–Ω'] * 10 + ['–í–æ–∑–≤—Ä–∞—Ç'] * 5


def generate_products():
    """
    –°–æ–∑–¥–∞—ë—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ 100 —Ç–æ–≤–∞—Ä–æ–≤.
    
    –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
    - –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–∞–ø—è—Ç—ã–µ, –æ–Ω–∏ –±—É–¥—É—Ç –∑–∞–∫–ª—é—á–µ–Ω—ã –≤ –∫–∞–≤—ã—á–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —á–∏—Å–ª–∞ —Ü–µ–ª—ã–µ (–±–µ–∑ –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ –¥–ª—è INTEGER –ø–æ–ª–µ–π)
    """
    products = []
    product_id = 1
    
    # –°–æ–∑–¥–∞—ë–º –ø–æ 20 —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π √ó 20 = 100 —Ç–æ–≤–∞—Ä–æ–≤)
    for i, category in enumerate(CATEGORIES):
        brand = BRANDS[i]
        base_names = PRODUCT_NAMES[category]
        
        for j in range(20):
            # –ë–µ—Ä—ë–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ (—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä–æ–≤ –±–æ–ª—å—à–µ —á–µ–º –Ω–∞–∑–≤–∞–Ω–∏–π)
            name = base_names[j % len(base_names)]
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ü–µ–Ω—ã: –∑–∞–∫—É–ø–æ—á–Ω–∞—è –æ—Ç 500 –¥–æ 5000 —Ä—É–±–ª–µ–π
            # –í–ê–ñ–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞, –±–µ–∑ –∫–æ–ø–µ–µ–∫ (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)
            purchase_price = random.randint(500, 5000)
            
            # –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ = –∑–∞–∫—É–ø–æ—á–Ω–∞—è + 20% –Ω–∞—Ü–µ–Ω–∫–∞
            # int() —É–±–∏—Ä–∞–µ—Ç –¥—Ä–æ–±–Ω—É—é —á–∞—Å—Ç—å, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
            current_price = int(purchase_price * 1.2)
            
            # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ –æ—Ç 0 –¥–æ 100
            stock = random.randint(0, 100)
            
            # –°–æ–∑–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞
            # –í–ê–ñ–ù–û: –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏ —Ç–∏–ø–∞–º–∏ (—á–∏—Å–ª–∞, —Å—Ç—Ä–æ–∫–∏)
            # –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ä–µ–∫—Ç—ã –∏–ª–∏ —Å–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
            products.append({
                'product_id': product_id,           # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
                'product_name': name.strip(),       # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
                'category': category.strip(),       # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
                'brand': brand.strip(),             # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
                'purchase_price': purchase_price,   # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
                'current_price': current_price,     # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
                'stock': stock                      # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
            })
            product_id += 1
    
    return products


def get_product_id_by_season(month):
    """
    –í—ã–±–∏—Ä–∞–µ—Ç product_id —Å —É—á—ë—Ç–æ–º —Å–µ–∑–æ–Ω–∞ –¥–ª—è –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    
    –õ–æ–≥–∏–∫–∞:
    - –õ–µ—Ç–æ (6,7,8): —á–∞—â–µ –æ–¥–µ–∂–¥–∞ (—Ç–æ–≤–∞—Ä—ã 21-40)
    - –ó–∏–º–∞ (11,12,1): —á–∞—â–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ (—Ç–æ–≤–∞—Ä—ã 1-20)
    - –û—Å—Ç–∞–ª—å–Ω–æ–µ: —Å–ª—É—á–∞–π–Ω—ã–π —Ç–æ–≤–∞—Ä –∏–∑ –≤—Å–µ—Ö 100
    
    –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
    - –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤, –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω—ã (21-40, 1-20)
    """
    if month in [6, 7, 8]:
        # –õ–µ—Ç–æ–º 50% —à–∞–Ω—Å ‚Äî –æ–¥–µ–∂–¥–∞ (—Ç–æ–≤–∞—Ä—ã —Å ID 21-40)
        if random.random() < 0.5:
            return random.randint(21, 40)
    elif month in [11, 12, 1]:
        # –ó–∏–º–æ–π 50% —à–∞–Ω—Å ‚Äî —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ (—Ç–æ–≤–∞—Ä—ã —Å ID 1-20)
        if random.random() < 0.5:
            return random.randint(1, 20)
    
    # –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö ‚Äî —Å–ª—É—á–∞–π–Ω—ã–π —Ç–æ–≤–∞—Ä –∏–∑ –≤—Å–µ—Ö 100
    return random.randint(1, 100)


def generate_sales(products):
    """
    –°–æ–∑–¥–∞—ë—Ç 5000 –ø—Ä–æ–¥–∞–∂ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤ (180 –¥–Ω–µ–π).
    
    –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
    1. –î–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ 'YYYY-MM-DD' (–Ω–∞–ø—Ä–∏–º–µ—Ä: '2025-01-15')
       - –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç 'DD.MM.YYYY' –∏–ª–∏ 'MM/DD/YYYY'
       - PostgreSQL —Å—Ç—Ä–æ–≥–æ —Ç—Ä–µ–±—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç ISO 8601
    
    2. product_id –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ products
       - –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä–∞ —Å —Ç–∞–∫–∏–º ID –Ω–µ—Ç, –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞
    
    3. –í—Å–µ —á–∏—Å–ª–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ü–µ–ª—ã–º–∏ (–±–µ–∑ –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤)
       - quantity –∏ customer_id - —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
       - price –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å current_price –∏–∑ products
    
    4. –°—Ç–∞—Ç—É—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ STATUSES
       - –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω –¥–æ–ø—É—Å—Ç–∏–º –≤ –ë–î
    """
    sales = []
    
    # –°–æ–∑–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º —Ç–æ–≤–∞—Ä–∞ –ø–æ ID
    # –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–¥–∞–∂–∏
    products_dict = {p['product_id']: p for p in products}
    
    # –ü–µ—Ä–∏–æ–¥: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 180 –¥–Ω–µ–π (6 –º–µ—Å—è—Ü–µ–≤)
    end_date = datetime.now()
    start_date = end_date - timedelta(days=180)
    
    # –°–æ–∑–¥–∞—ë–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –¥–∞—Ç –∑–∞ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥
    all_dates = []
    current_date = start_date
    while current_date <= end_date:
        all_dates.append(current_date)
        current_date += timedelta(days=1)
    
    # –ù–æ—è–±—Ä—å (–ß—ë—Ä–Ω–∞—è –ø—è—Ç–Ω–∏—Ü–∞): –¥–æ–±–∞–≤–ª—è–µ–º –¥–∞—Ç—ã –Ω–æ—è–±—Ä—è –ø–æ 3 —Ä–∞–∑–∞
    # –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –±–æ–ª—å—à–µ –ø—Ä–æ–¥–∞–∂ –≤ –Ω–æ—è–±—Ä–µ (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞—Å–ø—Ä–æ–¥–∞–∂)
    november_dates = [d for d in all_dates if d.month == 11]
    date_pool = all_dates + november_dates + november_dates
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 5000 –ø—Ä–æ–¥–∞–∂
    for sale_id in range(1, 5001):
        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –¥–∞—Ç—É (–Ω–æ—è–±—Ä—å –≤—ã–ø–∞–¥–∞–µ—Ç —á–∞—â–µ)
        date = random.choice(date_pool)
        
        # –í–ê–ñ–ù–û: —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã 'YYYY-MM-DD' –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è PostgreSQL
        # strftime('%Y-%m-%d') —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä–æ–∫—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ '2025-01-15'
        date_str = date.strftime('%Y-%m-%d')
        
        # –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–≤–∞—Ä —Å —É—á—ë—Ç–æ–º —Å–µ–∑–æ–Ω–∞
        product_id = get_product_id_by_season(date.month)
        product = products_dict[product_id]
        
        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –≤ –ø—Ä–æ–¥–∞–∂–µ (–æ—Ç 1 –¥–æ 3 —à—Ç—É–∫)
        quantity = random.randint(1, 3)
        
        # –¶–µ–Ω–∞ –±–µ—Ä—ë—Ç—Å—è –∏–∑ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–∞
        # –í–ê–ñ–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –±–µ–∑ –∫–æ–ø–µ–µ–∫
        price = product['current_price']
        
        # –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ (85% –¥–æ—Å—Ç–∞–≤–ª–µ–Ω, 10% –æ—Ç–º–µ–Ω–µ–Ω, 5% –≤–æ–∑–≤—Ä–∞—Ç)
        status = random.choice(STATUSES)
        
        # –°–ª—É—á–∞–π–Ω—ã–π –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø–∏—Å–∫–∞
        city = random.choice(CITIES)
        
        # ID –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (–æ—Ç 1000 –¥–æ 9999)
        customer_id = random.randint(1000, 9999)
        
        # –°–æ–∑–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ–¥–∞–∂–∏
        # –í–ê–ñ–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º 'sale_date' –≤–º–µ—Å—Ç–æ 'date', —Ç–∞–∫ –∫–∞–∫ –≤ SQL —Ç–∞–±–ª–∏—Ü–µ –∫–æ–ª–æ–Ω–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è sale_date
        sales.append({
            'sale_id': sale_id,                     # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
            'sale_date': date_str,                  # –°—Ç—Ä–æ–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ 'YYYY-MM-DD'
            'product_id': product_id,               # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ (–¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ products)
            'quantity': quantity,                   # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ (1-3)
            'price': price,                         # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ (—Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞)
            'status': status.strip(),               # –°—Ç—Ä–æ–∫–∞ (—É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã)
            'city': city.strip(),                   # –°—Ç—Ä–æ–∫–∞ (—É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã)
            'customer_id': customer_id              # –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
        })
    
    return sales


def save_products_to_csv(products, filename='products.csv'):
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–≤–∞—Ä—ã –≤ CSV —Ñ–∞–π–ª.
    
    –í–ê–ñ–ù–û –¥–ª—è PostgreSQL:
    1. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å - –∑–∞–ø—è—Ç–∞—è (,)
    2. –ö–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8 —Å BOM (utf-8-sig) –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
    3. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
    4. csv.QUOTE_MINIMAL - –∫–∞–≤—ã—á–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (–µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–ø—è—Ç–∞—è –≤ —Ç–µ–∫—Å—Ç–µ)
    5. quoting=csv.QUOTE_MINIMAL - —É–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ –∫–∞–≤—ã—á–∫–∏ –≤–æ–∫—Ä—É–≥ —á–∏—Å–µ–ª
    
    –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
    - –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å SQL —Ç–∞–±–ª–∏—Ü–µ–π, –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
    - –ï—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ –æ—Ç–∫—Ä—ã—Ç –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∑–∞–ø–∏—Å—å –º–æ–∂–µ—Ç –Ω–µ —É–¥–∞—Ç—å—Å—è
    """
    filepath = os.path.join(OUTPUT_FOLDER, filename)
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
    # –í–ê–ñ–ù–û: –Ω–∞–∑–≤–∞–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∫–æ–ª–æ–Ω–æ–∫ –≤ SQL —Ç–∞–±–ª–∏—Ü–µ
    fieldnames = ['product_id', 'product_name', 'category', 
                  'brand', 'purchase_price', 'current_price', 'stock']
    
    # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å–∏
    # 'w' - —Ä–µ–∂–∏–º –∑–∞–ø–∏—Å–∏ (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    # newline='' - —É–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –º–µ–∂–¥—É –∑–∞–ø–∏—Å—è–º–∏
    # encoding='utf-8-sig' - UTF-8 —Å BOM (–¥–ª—è Excel –∏ DBeaver)
    with open(filepath, 'w', newline='', encoding='utf-8-sig') as f:
        # –°–æ–∑–¥–∞—ë–º writer –¥–ª—è CSV
        # delimiter=',' - —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∑–∞–ø—è—Ç–∞—è
        # quoting=csv.QUOTE_MINIMAL - –∫–∞–≤—ã—á–∫–∏ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ
        writer = csv.DictWriter(f, fieldnames=fieldnames, delimiter=',', quoting=csv.QUOTE_MINIMAL)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∫–æ–ª–æ–Ω–æ–∫)
        writer.writeheader()
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
        writer.writerows(products)
    
    print(f'[OK] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª {filename} ({len(products)} —Ç–æ–≤–∞—Ä–æ–≤)')


def save_sales_to_csv(sales, filename='sales.csv'):
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–¥–∞–∂–∏ –≤ CSV —Ñ–∞–π–ª.
    
    –í–ê–ñ–ù–û –¥–ª—è PostgreSQL:
    1. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å - –∑–∞–ø—è—Ç–∞—è (,)
    2. –ö–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8 —Å BOM (utf-8-sig)
    3. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
    4. –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ 'sale_date' –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å SQL —Ç–∞–±–ª–∏—Ü–µ–π
    
    –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
    1. –ö–æ–ª–æ–Ω–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è 'sale_date', –∞ –Ω–µ 'date' (–∫–∞–∫ –≤ SQL —Ç–∞–±–ª–∏—Ü–µ)
    2. –ï—Å–ª–∏ product_id –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ products, –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞
    3. –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, PostgreSQL –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É
    4. –ï—Å–ª–∏ —Ñ–∞–π–ª –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π (>100MB), –∏–º–ø–æ—Ä—Ç –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    """
    filepath = os.path.join(OUTPUT_FOLDER, filename)
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
    # –í–ê–ñ–ù–û: 'sale_date' –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∫–æ–ª–æ–Ω–∫–∏ –≤ SQL —Ç–∞–±–ª–∏—Ü–µ
    fieldnames = ['sale_id', 'sale_date', 'product_id', 'quantity', 
                  'price', 'status', 'city', 'customer_id']
    
    # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å–∏
    with open(filepath, 'w', newline='', encoding='utf-8-sig') as f:
        # –°–æ–∑–¥–∞—ë–º writer –¥–ª—è CSV
        writer = csv.DictWriter(f, fieldnames=fieldnames, delimiter=',', quoting=csv.QUOTE_MINIMAL)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        writer.writeheader()
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤—Å–µ –ø—Ä–æ–¥–∞–∂–∏
        writer.writerows(sales)
    
    print(f'[OK] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª {filename} ({len(sales)} –ø—Ä–æ–¥–∞–∂)')


# ==================== –û–°–ù–û–í–ù–ê–Ø –ü–†–û–ì–†–ê–ú–ú–ê ====================
if __name__ == '__main__':
    print('=' * 60)
    print('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö Ozon –¥–ª—è PostgreSQL')
    print('=' * 60)
    
    try:
        # –®–∞–≥ 1: –°–æ–∑–¥–∞—ë–º 100 —Ç–æ–≤–∞—Ä–æ–≤
        print('\n[1/2] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤...')
        products = generate_products()
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ 100 —Ç–æ–≤–∞—Ä–æ–≤
        if len(products) != 100:
            print(f'[–û–®–ò–ë–ö–ê] –°–æ–∑–¥–∞–Ω–æ {len(products)} —Ç–æ–≤–∞—Ä–æ–≤ –≤–º–µ—Å—Ç–æ 100!')
            sys.exit(1)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–≤–∞—Ä—ã –≤ CSV
        save_products_to_csv(products, 'products.csv')
        
        # –®–∞–≥ 2: –°–æ–∑–¥–∞—ë–º 5000 –ø—Ä–æ–¥–∞–∂
        print('\n[2/2] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂...')
        sales = generate_sales(products)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ 5000 –ø—Ä–æ–¥–∞–∂
        if len(sales) != 5000:
            print(f'[–û–®–ò–ë–ö–ê] –°–æ–∑–¥–∞–Ω–æ {len(sales)} –ø—Ä–æ–¥–∞–∂ –≤–º–µ—Å—Ç–æ 5000!')
            sys.exit(1)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–¥–∞–∂–∏ –≤ CSV
        save_sales_to_csv(sales, 'sales.csv')
        
        # –ò—Ç–æ–≥–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        print('\n' + '=' * 60)
        print('–ì–æ—Ç–æ–≤–æ! –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã:')
        print(f'  üìÅ –ü–∞–ø–∫–∞: {OUTPUT_FOLDER}')
        print(f'  üìÑ products.csv - {len(products)} —Ç–æ–≤–∞—Ä–æ–≤')
        print(f'  üìÑ sales.csv - {len(sales)} –ø—Ä–æ–¥–∞–∂')
        print('\n–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–º–ø–æ—Ä—Ç—É –≤ DBeaver:')
        print('  1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É products')
        print('  2. –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π ‚Üí Import Data')
        print('  3. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª products.csv')
        print('  4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å = –∑–∞–ø—è—Ç–∞—è')
        print('  5. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã sales')
        print('=' * 60)
        
    except Exception as e:
        # –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –≤—ã–≤–æ–¥–∏–º –æ—à–∏–±–∫—É
        print(f'\n[–û–®–ò–ë–ö–ê] –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫: {e}')
        print('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ:')
        print('  - –ü–∞–ø–∫–∞ OUTPUT_FOLDER —Å—É—â–µ—Å—Ç–≤—É–µ—Ç')
        print('  - –£ –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —ç—Ç—É –ø–∞–ø–∫—É')
        print('  - –§–∞–π–ª—ã –Ω–µ –æ—Ç–∫—Ä—ã—Ç—ã –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ')
        sys.exit(1)
